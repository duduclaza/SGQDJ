# ğŸ—ï¸ ARQUITETURA DO SISTEMA - SGQ OTI DJ

## ğŸ“ Diagrama de Arquitetura Geral

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CAMADA DE APRESENTAÃ‡ÃƒO                      â”‚
â”‚                                (Frontend)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Browser    â”‚  â”‚   Mobile     â”‚  â”‚    API       â”‚              â”‚
â”‚  â”‚   (HTML/JS)  â”‚  â”‚  (Futuro)    â”‚  â”‚  Clients     â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                 â”‚                  â”‚                       â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                           â”‚                                          â”‚
â”‚                           â–¼                                          â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚              â”‚   Tailwind CSS (CDN)      â”‚                          â”‚
â”‚              â”‚   JavaScript Vanilla      â”‚                          â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CAMADA DE ROTEAMENTO                            â”‚
â”‚                        (Entry Point)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                    public/index.php                       â”‚      â”‚
â”‚  â”‚                     (708 linhas)                          â”‚      â”‚
â”‚  â”‚                                                           â”‚      â”‚
â”‚  â”‚  â€¢ Inicia sessÃ£o                                          â”‚      â”‚
â”‚  â”‚  â€¢ Carrega .env                                           â”‚      â”‚
â”‚  â”‚  â€¢ Define headers no-cache                                â”‚      â”‚
â”‚  â”‚  â€¢ Registra 200+ rotas                                    â”‚      â”‚
â”‚  â”‚  â€¢ Aplica middleware de permissÃµes                        â”‚      â”‚
â”‚  â”‚  â€¢ Despacha requisiÃ§Ã£o                                    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                            â”‚                                         â”‚
â”‚                            â–¼                                         â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚              â”‚   Core/Router.php         â”‚                          â”‚
â”‚              â”‚   â€¢ Rotas estÃ¡ticas       â”‚                          â”‚
â”‚              â”‚   â€¢ Rotas dinÃ¢micas       â”‚                          â”‚
â”‚              â”‚   â€¢ Pattern matching      â”‚                          â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CAMADA DE MIDDLEWARE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚           Middleware/PermissionMiddleware.php           â”‚        â”‚
â”‚  â”‚                   (428 linhas)                          â”‚        â”‚
â”‚  â”‚                                                         â”‚        â”‚
â”‚  â”‚  â€¢ Verifica autenticaÃ§Ã£o (sessÃ£o)                       â”‚        â”‚
â”‚  â”‚  â€¢ Mapeia rota â†’ mÃ³dulo                                â”‚        â”‚
â”‚  â”‚  â€¢ Verifica permissÃµes (view/edit/delete)              â”‚        â”‚
â”‚  â”‚  â€¢ Retorna 403 se nÃ£o autorizado                       â”‚        â”‚
â”‚  â”‚  â€¢ Permite rotas pÃºblicas                              â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                            â”‚                                         â”‚
â”‚                            â–¼                                         â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚              â”‚ Services/PermissionServiceâ”‚                          â”‚
â”‚              â”‚ â€¢ hasPermission()         â”‚                          â”‚
â”‚              â”‚ â€¢ Consulta DB             â”‚                          â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CAMADA DE CONTROLE                              â”‚
â”‚                       (Controllers)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Admin      â”‚    Toners    â”‚ HomologaÃ§Ãµes â”‚   POPs/ITs   â”‚     â”‚
â”‚  â”‚ Controller   â”‚  Controller  â”‚  Controller  â”‚  Controller  â”‚     â”‚
â”‚  â”‚  (133 KB)    â”‚   (60 KB)    â”‚   (62 KB)    â”‚  (113 KB)    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Garantias   â”‚ Amostragens  â”‚  Fluxogramas â”‚     NPS      â”‚     â”‚
â”‚  â”‚  Controller  â”‚  Controller  â”‚  Controller  â”‚  Controller  â”‚     â”‚
â”‚  â”‚   (75 KB)    â”‚   (61 KB)    â”‚   (73 KB)    â”‚   (48 KB)    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                       â”‚
â”‚              + 37 outros controllers especializados                  â”‚
â”‚                                                                       â”‚
â”‚  Responsabilidades:                                                  â”‚
â”‚  â€¢ Receber requisiÃ§Ãµes                                               â”‚
â”‚  â€¢ Validar dados                                                     â”‚
â”‚  â€¢ Chamar services/models                                            â”‚
â”‚  â€¢ Retornar views ou JSON                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CAMADA DE SERVIÃ‡OS                              â”‚
â”‚                        (Services)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚              Services/EmailService.php                 â”‚         â”‚
â”‚  â”‚                    (108 KB)                            â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  â€¢ Envio de credenciais                                â”‚         â”‚
â”‚  â”‚  â€¢ NotificaÃ§Ãµes de aprovaÃ§Ã£o/reprovaÃ§Ã£o               â”‚         â”‚
â”‚  â”‚  â€¢ Alertas de controle de descartes                   â”‚         â”‚
â”‚  â”‚  â€¢ RecuperaÃ§Ã£o de senha                               â”‚         â”‚
â”‚  â”‚  â€¢ Emails personalizados                              â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  Usa: PHPMailer 6.9+                                   â”‚         â”‚
â”‚  â”‚  SMTP: smtp.hostinger.com:465 (SSL)                   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚          Services/PermissionService.php                â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  â€¢ hasPermission($userId, $module, $action)           â”‚         â”‚
â”‚  â”‚  â€¢ Consulta permissÃµes no banco                       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚          Services/MasterUserService.php                â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  â€¢ AutenticaÃ§Ã£o de usuÃ¡rio master                     â”‚         â”‚
â”‚  â”‚  â€¢ AprovaÃ§Ã£o de pagamentos financeiros                â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAMADA DE PERSISTÃŠNCIA                            â”‚
â”‚                      (Database Layer)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚              Config/Database.php                       â”‚         â”‚
â”‚  â”‚              (Singleton Pattern)                       â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  â€¢ getInstance() â†’ PDO                                 â”‚         â”‚
â”‚  â”‚  â€¢ ConexÃ£o persistente (ATTR_PERSISTENT)             â”‚         â”‚
â”‚  â”‚  â€¢ Error mode: PDO::ERRMODE_EXCEPTION                 â”‚         â”‚
â”‚  â”‚  â€¢ Fetch mode: PDO::FETCH_ASSOC                       â”‚         â”‚
â”‚  â”‚  â€¢ Charset: utf8mb4                                   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                            â”‚                                         â”‚
â”‚                            â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                  MySQL Database                        â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  Host: srv1890.hstgr.io:3306                          â”‚         â”‚
â”‚  â”‚  DB: u230868210_djsgqpro                              â”‚         â”‚
â”‚  â”‚  User: u230868210_dusouza                             â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  Principais Tabelas:                                   â”‚         â”‚
â”‚  â”‚  â€¢ users, profiles, permissions                       â”‚         â”‚
â”‚  â”‚  â€¢ toners, toners_retornados                          â”‚         â”‚
â”‚  â”‚  â€¢ homologacoes, homologacoes_anexos                  â”‚         â”‚
â”‚  â”‚  â€¢ amostragens_2, amostragens_evidencias             â”‚         â”‚
â”‚  â”‚  â€¢ pops_its_*, fluxogramas_*                          â”‚         â”‚
â”‚  â”‚  â€¢ garantias, garantias_anexos                        â”‚         â”‚
â”‚  â”‚  â€¢ nps_pesquisas, nps_respostas                       â”‚         â”‚
â”‚  â”‚  â€¢ notifications, logs                                â”‚         â”‚
â”‚  â”‚  + 50+ outras tabelas                                 â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CAMADA DE VISUALIZAÃ‡ÃƒO                          â”‚
â”‚                          (Views)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                  views/layouts/                        â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  â€¢ main.php - Layout principal do sistema             â”‚         â”‚
â”‚  â”‚  â€¢ Inclui header, sidebar, footer                     â”‚         â”‚
â”‚  â”‚  â€¢ Carrega Tailwind CSS via CDN                       â”‚         â”‚
â”‚  â”‚  â€¢ Sistema de notificaÃ§Ãµes                            â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                  views/pages/                          â”‚         â”‚
â”‚  â”‚                  (91 arquivos)                         â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  â€¢ toners/                                             â”‚         â”‚
â”‚  â”‚  â€¢ homologacoes/                                       â”‚         â”‚
â”‚  â”‚  â€¢ amostragens-2/                                      â”‚         â”‚
â”‚  â”‚  â€¢ pops-its/                                           â”‚         â”‚
â”‚  â”‚  â€¢ fluxogramas/                                        â”‚         â”‚
â”‚  â”‚  â€¢ garantias/                                          â”‚         â”‚
â”‚  â”‚  + 24 outros diretÃ³rios de mÃ³dulos                    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                  views/partials/                       â”‚         â”‚
â”‚  â”‚                                                        â”‚         â”‚
â”‚  â”‚  â€¢ header.php                                          â”‚         â”‚
â”‚  â”‚  â€¢ sidebar.php                                         â”‚         â”‚
â”‚  â”‚  â€¢ Componentes reutilizÃ¡veis                          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SERVIÃ‡OS EXTERNOS                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Power BI    â”‚  â”‚  SMTP        â”‚  â”‚  Tailwind    â”‚              â”‚
â”‚  â”‚    API       â”‚  â”‚  Hostinger   â”‚  â”‚    CDN       â”‚              â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚              â”‚
â”‚  â”‚ Consome API  â”‚  â”‚ Envia emails â”‚  â”‚ CSS externo  â”‚              â”‚
â”‚  â”‚ de garantias â”‚  â”‚ via PHP      â”‚  â”‚              â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Fluxo de uma RequisiÃ§Ã£o TÃ­pica

```
1. USUÃRIO
   â”‚
   â””â”€â–º Acessa URL: https://djbr.sgqoti.com.br/homologacoes
       â”‚
       â–¼
2. APACHE + .htaccess
   â”‚
   â””â”€â–º Rewrite para: /public/index.php
       â”‚
       â–¼
3. public/index.php
   â”‚
   â”œâ”€â–º Inicia sessÃ£o
   â”œâ”€â–º Carrega .env
   â”œâ”€â–º Define headers no-cache
   â”œâ”€â–º Registra rotas
   â””â”€â–º Despacha para Router
       â”‚
       â–¼
4. Core/Router
   â”‚
   â”œâ”€â–º Match de rota: /homologacoes â†’ GET
   â”œâ”€â–º Extrai handler: [HomologacoesKanbanController, 'index']
   â””â”€â–º Aplica middleware
       â”‚
       â–¼
5. PermissionMiddleware
   â”‚
   â”œâ”€â–º Verifica se usuÃ¡rio estÃ¡ logado
   â”œâ”€â–º Mapeia rota â†’ mÃ³dulo 'homologacoes'
   â”œâ”€â–º Verifica permissÃ£o: hasPermission($userId, 'homologacoes', 'view')
   â”‚   â”‚
   â”‚   â””â”€â–º PermissionService consulta DB
   â”‚       â”‚
   â”‚       â”œâ”€â–º SIM â†’ Prossegue
   â”‚       â””â”€â–º NÃƒO â†’ Retorna 403 Forbidden
       â”‚
       â–¼
6. HomologacoesKanbanController::index()
   â”‚
   â”œâ”€â–º Busca dados do banco via PDO
   â”‚   â”‚
   â”‚   â””â”€â–º Database::getInstance() â†’ PDO
   â”‚       â”‚
   â”‚       â””â”€â–º MySQL (srv1890.hstgr.io)
   â”‚
   â”œâ”€â–º Processa lÃ³gica de negÃ³cio
   â””â”€â–º Retorna view
       â”‚
       â–¼
7. views/pages/homologacoes/index.php
   â”‚
   â”œâ”€â–º Inclui layout: views/layouts/main.php
   â”œâ”€â–º Renderiza HTML com Tailwind CSS
   â””â”€â–º Inclui JavaScript para interaÃ§Ãµes
       â”‚
       â–¼
8. NAVEGADOR
   â”‚
   â””â”€â–º Exibe pÃ¡gina para usuÃ¡rio
```

---

## ğŸ—ƒï¸ Estrutura de Pastas Detalhada

```
SGQDJ/
â”‚
â”œâ”€â”€ ğŸ“ public/                          # DocumentRoot (Apache)
â”‚   â”œâ”€â”€ ğŸ“„ index.php                    # Entry point (708 linhas)
â”‚   â”œâ”€â”€ ğŸ“„ .htaccess                    # Rewrite rules
â”‚   â”œâ”€â”€ ğŸ“ assets/                      # Recursos estÃ¡ticos
â”‚   â”‚   â”œâ”€â”€ ğŸ“ css/                     # Estilos customizados
â”‚   â”‚   â”œâ”€â”€ ğŸ“ images/                  # Imagens do sistema
â”‚   â”‚   â”œâ”€â”€ ğŸ“ fonts/                   # Fontes
â”‚   â”‚   â””â”€â”€ ğŸ“ icons/                   # Ãcones
â”‚   â””â”€â”€ ğŸ“ js/                          # JavaScript
â”‚       â”œâ”€â”€ ğŸ“„ main.js
â”‚       â”œâ”€â”€ ğŸ“„ notifications.js
â”‚       â”œâ”€â”€ ğŸ“„ charts.js
â”‚       â””â”€â”€ ğŸ“„ utils.js
â”‚
â”œâ”€â”€ ğŸ“ src/                             # CÃ³digo-fonte PHP
â”‚   â”œâ”€â”€ ğŸ“ Controllers/                 # 45 controllers
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ AdminController.php      # 133 KB âš ï¸
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PopItsController.php     # 113 KB âš ï¸
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ TonersController.php     # 60 KB
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ HomologacoesKanbanController.php # 62 KB
â”‚   â”‚   â””â”€â”€ ... (41 outros)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ Core/                        # NÃºcleo do sistema
â”‚   â”‚   â””â”€â”€ ğŸ“„ Router.php               # Sistema de rotas
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ Config/                      # ConfiguraÃ§Ãµes
â”‚   â”‚   â””â”€â”€ ğŸ“„ Database.php             # Singleton PDO
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ Middleware/                  # Middlewares
â”‚   â”‚   â””â”€â”€ ğŸ“„ PermissionMiddleware.php # AutorizaÃ§Ã£o
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ Services/                    # ServiÃ§os
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ EmailService.php         # 108 KB âš ï¸
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PermissionService.php
â”‚   â”‚   â””â”€â”€ ğŸ“„ MasterUserService.php
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ Support/                     # Helpers
â”‚   â”‚   â””â”€â”€ ğŸ“„ helpers.php              # FunÃ§Ãµes globais
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ Cron/                        # Tarefas agendadas
â”‚       â””â”€â”€ ğŸ“„ FinanceiroCron.php
â”‚
â”œâ”€â”€ ğŸ“ views/                           # Templates
â”‚   â”œâ”€â”€ ğŸ“ layouts/                     # Layouts base
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ main.php                 # Layout principal
â”‚   â”‚   â””â”€â”€ ğŸ“„ blank.php                # Layout limpo
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ partials/                    # Componentes
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ header.php
â”‚   â”‚   â””â”€â”€ ğŸ“„ sidebar.php
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ pages/                       # PÃ¡ginas (91)
â”‚       â”œâ”€â”€ ğŸ“ admin/
â”‚       â”œâ”€â”€ ğŸ“ auth/
â”‚       â”œâ”€â”€ ğŸ“ toners/
â”‚       â”œâ”€â”€ ğŸ“ homologacoes/
â”‚       â”œâ”€â”€ ğŸ“ pops-its/
â”‚       â”œâ”€â”€ ğŸ“ fluxogramas/
â”‚       â”œâ”€â”€ ğŸ“ garantias/
â”‚       â”œâ”€â”€ ğŸ“ amostragens-2/
â”‚       â”œâ”€â”€ ğŸ“ nps/
â”‚       â””â”€â”€ ... (22 outros)
â”‚
â”œâ”€â”€ ğŸ“ database/                        # Scripts SQL
â”‚   â”œâ”€â”€ ğŸ“„ criar_todas_tabelas.sql
â”‚   â”œâ”€â”€ ğŸ“„ nao_conformidades.sql
â”‚   â”œâ”€â”€ ğŸ“„ estrutura_melhoria_continua_2.sql
â”‚   â”œâ”€â”€ ğŸ“„ homologacoes_log_detalhado.sql
â”‚   â””â”€â”€ ... (11 outros scripts)
â”‚
â”œâ”€â”€ ğŸ“ storage/                         # Armazenamento
â”‚   â”œâ”€â”€ ğŸ“ logs/                        # Logs da aplicaÃ§Ã£o
â”‚   â”‚   â””â”€â”€ ğŸ“„ app_2025-12-04.log
â”‚   â”œâ”€â”€ ğŸ“ cache/                       # Cache (futuro)
â”‚   â””â”€â”€ ğŸ“ temp/                        # TemporÃ¡rios
â”‚
â”œâ”€â”€ ğŸ“ uploads/                         # Uploads de usuÃ¡rios
â”‚   â”œâ”€â”€ ğŸ“ anexos/
â”‚   â”œâ”€â”€ ğŸ“ evidencias/
â”‚   â”œâ”€â”€ ğŸ“ certificados/
â”‚   â””â”€â”€ ğŸ“ fotos_perfil/
â”‚
â”œâ”€â”€ ğŸ“ vendor/                          # DependÃªncias Composer
â”‚   â”œâ”€â”€ ğŸ“ phpoffice/phpspreadsheet/
â”‚   â”œâ”€â”€ ğŸ“ phpmailer/phpmailer/
â”‚   â”œâ”€â”€ ğŸ“ vlucas/phpdotenv/
â”‚   â””â”€â”€ ğŸ“ nesbot/carbon/
â”‚
â”œâ”€â”€ ğŸ“„ .env                             # VariÃ¡veis de ambiente
â”œâ”€â”€ ğŸ“„ .env.example                     # Template .env
â”œâ”€â”€ ğŸ“„ .gitignore                       # Arquivos ignorados
â”œâ”€â”€ ğŸ“„ composer.json                    # DependÃªncias
â”œâ”€â”€ ğŸ“„ composer.lock                    # VersÃµes travadas
â”œâ”€â”€ ğŸ“„ index.php                        # Fallback (redireciona)
â”œâ”€â”€ ğŸ“„ README.md                        # DocumentaÃ§Ã£o
â”œâ”€â”€ ğŸ“„ ANALISE_PROJETO.md              # Esta anÃ¡lise âœ¨
â””â”€â”€ ğŸ“„ RESUMO_EXECUTIVO.md             # Resumo executivo
```

---

## ğŸ”Œ IntegraÃ§Ãµes e DependÃªncias Externas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SISTEMA SGQ OTI - DJ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚
        â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Hostinger   â”‚    â”‚   Power BI   â”‚
â”‚              â”‚    â”‚              â”‚
â”‚ â€¢ MySQL DB   â”‚    â”‚ â€¢ Consome    â”‚
â”‚ â€¢ SMTP       â”‚    â”‚   API de     â”‚
â”‚ â€¢ Hosting    â”‚    â”‚   Garantias  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚
        â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         â”‚                   â”‚
        â–¼         â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tailwind CDN â”‚ â”‚ PHPMailer    â”‚ â”‚ PHPSpreadsheetâ”‚
â”‚              â”‚ â”‚              â”‚ â”‚              â”‚
â”‚ â€¢ CSS        â”‚ â”‚ â€¢ SMTP       â”‚ â”‚ â€¢ Excel      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ­ PadrÃµes de Design Identificados

### 1. Singleton
```php
// Database.php
Database::getInstance() â†’ PDO Ãºnico
```

### 2. MVC (Model-View-Controller)
```php
Controller â†’ View
         â””â†’ Model (via PDO direto)
```

### 3. Middleware
```php
Router â†’ PermissionMiddleware â†’ Controller
```

### 4. Service Layer
```php
Controller â†’ EmailService
         â””â†’ PermissionService
```

### 5. Front Controller
```php
Todas requisiÃ§Ãµes â†’ public/index.php
```

---

## ğŸ“Š MÃ©tricas de Arquitetura

| Camada | Arquivos | LOC (est.) | Complexidade |
|--------|----------|------------|--------------|
| **Entry Point** | 1 | 708 | ğŸ”´ Alta |
| **Router** | 1 | 141 | ğŸŸ¢ Baixa |
| **Middleware** | 1 | 428 | ğŸŸ¡ MÃ©dia |
| **Controllers** | 45 | 35.000+ | ğŸ”´ Muito Alta |
| **Services** | 3 | 4.000+ | ğŸŸ¡ Alta |
| **Views** | 114 | 15.000+ | ğŸŸ¡ MÃ©dia |
| **Config** | 1 | 38 | ğŸŸ¢ Baixa |
| **Database Scripts** | 15+ | 3.000+ | ğŸŸ¡ MÃ©dia |

**Total Estimado:** ~50.000 linhas de cÃ³digo

---

## ğŸš¦ Fluxo de AutenticaÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UsuÃ¡rio   â”‚
â”‚ nÃ£o logado  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â–º Acessa /homologacoes
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PermissionMiddle â”‚
â”‚     ware         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â–º Verifica $_SESSION['user_id']
       â”‚   â””â”€â–º NÃƒO EXISTE
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redireciona para â”‚
â”‚     /login       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AuthController  â”‚
â”‚   ::login()      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â–º Exibe formulÃ¡rio de login
           â”‚
           â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ UsuÃ¡rio insereâ”‚
       â”‚ email + senha â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ POST /auth/login   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ AuthController     â”‚
       â”‚ ::authenticate()   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”œâ”€â–º Valida credenciais no DB
               â”‚   â”‚
               â”‚   â”œâ”€â–º VÃLIDO
               â”‚   â”‚   â””â”€â–º Cria $_SESSION['user_id']
               â”‚   â”‚   â””â”€â–º Redireciona para /
               â”‚   â”‚
               â”‚   â””â”€â–º INVÃLIDO
               â”‚       â””â”€â–º Retorna erro
               â”‚
               â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   Dashboard ou     â”‚
       â”‚   Primeiro mÃ³dulo  â”‚
       â”‚   com permissÃ£o    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Fluxo de AutorizaÃ§Ã£o (PermissÃµes)

```
REQUEST: GET /homologacoes
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PermissionMiddleware       â”‚
â”‚  ::handle()                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€â–º 1. Verifica se Ã© rota pÃºblica
          â”‚   â””â”€â–º NÃƒO
          â”‚
          â”œâ”€â–º 2. Verifica $_SESSION['user_id']
          â”‚   â””â”€â–º EXISTE (user_id = 5)
          â”‚
          â”œâ”€â–º 3. Mapeia rota â†’ mÃ³dulo
          â”‚   â””â”€â–º '/homologacoes' â†’ 'homologacoes'
          â”‚
          â”œâ”€â–º 4. Determina aÃ§Ã£o pelo mÃ©todo HTTP
          â”‚   â””â”€â–º GET â†’ 'view'
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PermissionService          â”‚
â”‚  ::hasPermission(           â”‚
â”‚    userId: 5,               â”‚
â”‚    module: 'homologacoes',  â”‚
â”‚    action: 'view'           â”‚
â”‚  )                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€â–º Consulta DB:
          â”‚   SELECT * FROM permissions
          â”‚   WHERE user_id = 5
          â”‚   AND module = 'homologacoes'
          â”‚   AND action_view = 1
          â”‚
          â”œâ”€â–º Resultado?
          â”‚   â”‚
          â”‚   â”œâ”€â–º SIM â†’ return true
          â”‚   â”‚   â”‚
          â”‚   â”‚   â””â”€â–º Middleware permite
          â”‚   â”‚       â”‚
          â”‚   â”‚       â””â”€â–º Controller executado
          â”‚   â”‚
          â”‚   â””â”€â–º NÃƒO â†’ return false
          â”‚       â”‚
          â”‚       â””â”€â–º Middleware bloqueia
          â”‚           â”‚
          â”‚           â””â”€â–º HTTP 403 Forbidden
```

---

**Documento criado em:** 04/12/2025  
**Ferramenta:** Antigravity AI  
**Formato:** Markdown + Diagramas ASCII

