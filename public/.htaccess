# Use Apache rewriting to route everything to public/index.php
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # Serve existing files and directories as is
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Otherwise route to index.php
  RewriteRule ^ index.php [L]
</IfModule>

# Forçar no-cache para arquivos PHP e HTML (evitar cache do navegador)
<IfModule mod_headers.c>
  # Headers gerais anti-cache
  Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0, post-check=0, pre-check=0"
  Header set Pragma "no-cache"
  Header set Expires "Sat, 01 Jan 2000 00:00:00 GMT"
  
  # ETag desabilitado para evitar cache baseado em hash
  Header unset ETag
  FileETag None
  
  # Forçar revalidação
  Header set Vary "Accept-Encoding"
</IfModule>

# Desabilitar cache para arquivos PHP
<FilesMatch "\.php$">
  <IfModule mod_headers.c>
    Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
  </IfModule>
</FilesMatch>
